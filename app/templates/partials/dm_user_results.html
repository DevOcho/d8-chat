{# This partial renders the list of users and the "Load More" button. #}
<div class="list-group list-group-flush {% if current_page > 1 %}border-top{% endif %}">
    {% for user in users_to_start_dm %}
        <a href="#"
           class="list-group-item list-group-item-action"
           hx-get="{{ url_for('main.get_dm_chat', other_user_id=user.id) }}"
           hx-target="#chat-messages-container"
           data-bs-dismiss="modal">
            {{ user.display_name ~ ' (' ~ user.username ~ ')' if user.display_name else user.username }}
        </a>
    {% else %}
        {% if request.args.get('q') %}<div class="list-group-item text-muted">No users match your search.</div>{% endif %}
    {% endfor %}
</div>
{# "Load More" button for pagination #}
{% if has_more_pages %}
    <div class="mt-3 text-center"
         hx-get="{{ url_for('main.search_users_for_dm', q=request.args.get('q', '') , page=current_page + 1) }}"
         hx-target="this"
         hx-swap="outerHTML">
        <button class="btn btn-outline-secondary">Load More</button>
    </div>
{% endif %}
