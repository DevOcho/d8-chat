<!-- This partial renders a list of user results and a "Load More" button -->
{% for user in users %}
    {# [THE FIX] Use a DIV instead of an A tag to prevent default browser navigation #}
    <div class="text-decoration-none text-body search-result-item d-flex align-items-center py-2"
         style="cursor: pointer"
         hx-get="{{ url_for('dms.get_dm_chat', other_user_id=user.id) }}"
         hx-target="#chat-messages-container"
         hx-swap="innerHTML">
        <div class="flex-shrink-0">
            <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center"
                 style="width: 32px;
                        height: 32px">{{ (user.display_name or user.username)[0]|upper }}</div>
        </div>
        <div class="flex-grow-1 ms-3">
            <strong>{{ (user.display_name or user.username) | highlight(query) }}</strong>
            <small class="text-muted d-block">{{ user.username | highlight(query) }}</small>
        </div>
    </div>
{% else %}
    {% if not request.args.get('page') or request.args.get('page') == '1' %}
        <p class="text-muted">No people found matching your search.</p>
    {% endif %}
{% endfor %}
{% if has_more_users %}
    <div class="mt-3 text-center"
         hx-get="{{ url_for('search.search_users_paginated', q=query, page=current_page + 1) }}"
         hx-target="this"
         hx-swap="outerHTML">
        <button class="btn btn-outline-secondary">Load More</button>
    </div>
{% endif %}
