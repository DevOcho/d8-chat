<div id="chat-input-container" class="chat-input-form bg-light">
    {# ... quoted message UI ... #}
    <div class="quoted-reply p-2 mb-2">
        <strong>Replying to {{ message.user.username }}</strong>
        <p class="mb-0 text-muted text-truncate">{{ message.content }}</p>
        <button class="btn-close" aria-label="Close" style="position: absolute; top: 5px; right: 10px;" hx-get="/chat/input/default" hx-target="#chat-input-container" hx-swap="outerHTML"></button>
    </div>

    {# ... message form ... #}
    <div id="typing-indicator" class="text-muted small" style="height: 20px;"></div>
    <form ws-send id="message-form" autocomplete="off">
        <input type="hidden" name="parent_message_id" value="{{ message.id }}">
        <div class="input-group">
            <textarea id="chat-message-input" name="chat_message" class="form-control" placeholder="Reply..." rows="1" style="resize: none;"></textarea>
            <button id="send-button" type="submit" class="btn btn-primary">Reply</button>
        </div>
    </form>
    <div id="typing-sender" ws-send hx-trigger="typing-event" style="display: none;"></div>
</div>

{# This script will run as soon as the partial is loaded into the DOM #}
<script>
    document.body.dispatchEvent(new Event('chatInputLoaded'));
</script>
