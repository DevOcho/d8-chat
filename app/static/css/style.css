body, html {
  height: 100%;
  overflow: hidden;
}
.main-layout {
  display: flex;
  flex-direction: row;
  height: 100vh;
}
.sidebar {
  flex-shrink: 0;
  overflow-y: auto;
}
.workspace-sidebar {
  width: 70px;
  background-color: #3f0e40;
  display: flex;
  flex-direction: column;
}
.channel-sidebar {
  width: 260px;
  background-color: #4a154b;
  color: #d1d2d3;
}
.main-content,
.container-fluid {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  height: 100vh;
  background-color: #ffffff;
  position: relative;
}
.container-fluid {
    background-color: #f4f7fa;
    display: block;
}
.chat-messages {
  flex-grow: 1;
  overflow-y: auto;
  padding: 1rem;
}
.chat-input-form {
  flex-shrink: 0;
  padding: 1rem;
  background-color: #f8f9fa;
}
/* Change this selector */
form[id^="message-form"] {
  position: relative;
}
.message-container {
  position: relative;
  padding: 0.5rem;
  border-radius: 0.25rem;
  transition: background-color 0.15s ease-in-out;
}

.message-container:hover {
  background-color: #f8f9fa; /* A subtle light gray for light mode */
}

[data-bs-theme="dark"] .message-container:hover {
    background-color: #313a4a; /* row highlight */
}

.message-content {
    word-wrap: break-word;
    overflow-x: auto; /* For code blocks */
    overflow-y: hidden; /* Prevents vertical scrollbar bug with mentions */
}

.message-toolbar {
  position: absolute;
  top: 0;
  right: 0.5rem;
  display: none;
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 0.25rem;
  padding: 0.25rem;
}
.message-container:hover .message-toolbar {
  display: block;
}
.quoted-reply {
  position: relative;
  background-color: #e9e9e9;
  border-left: 4px solid #03a9f4;
  border-radius: 4px;
  font-size: 0.9em;
  padding: 0.5em;
}
.codehilite {
    max-width: 100%;
    background: #27222;
    color: #f8f8f2;
    padding: 1em;
    border-radius: 4px;
}

/* --- [RESTORED] Login Page Styles --- */
html.login-page, body.login-page { overflow: auto; }
html.admin-page, body.admin-page { overflow: auto; }
.login-page-container { display: flex; min-height: 100vh; width: 100%; background-color: #f8f9fa; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
.feature-panel { flex-basis: 45%; background-color: #1a1d21; color: #ffffff; padding: 3rem 4rem; display: flex; flex-direction: column; justify-content: center; }
.login-logo { max-width: 250px; height: auto; }
.feature-list { list-style: none; padding: 0; }
.feature-list li { font-size: 1.1rem; margin-bottom: 1rem; display: flex; align-items: center; }
.feature-list li i { color: #ec729c; font-size: 1.5rem; margin-right: 1rem; width: 30px; }
.login-panel { flex-basis: 55%; display: flex; justify-content: center; align-items: center; padding: 2rem; background-color: #ffffff; }
.login-form-container { max-width: 420px; width: 100%; }
.sso-divider { display: flex; align-items: center; text-align: center; color: #6c757d; margin: 2rem 0; }
.sso-divider::before, .sso-divider::after { content: ''; flex: 1; border-bottom: 1px solid #dee2e6; }
.sso-divider:not(:empty)::before { margin-right: .5em; }
.sso-divider:not(:empty)::after { margin-left: .5em; }
.btn-sso-authentik, .btn-sso-google { font-size: 1rem; padding: 0.75rem; border: 1px solid #dee2e6; background-color: #ffffff; color: #212529; text-align: center; }
.btn-sso-authentik:hover, .btn-sso-google:hover { background-color: #f8f9fa; border-color: #adb5bd; }
.btn-sso-authentik i, .btn-sso-google i { margin-right: 0.5rem; }
@media (max-width: 992px) { .login-page-container { flex-direction: column; } .feature-panel { flex-basis: auto; padding: 2rem; text-align: center; } .feature-list li { justify-content: center; } .login-logo { margin-left: auto; margin-right: auto; } .login-panel { flex-basis: auto; flex-grow: 1; } }

/* --- General App Styles --- */
.mentioned-message {
  background-color: #fffbeA;
  border-left: 3px solid #ffd700;
  transition: background-color 0.5s ease-in-out;
}
.channel-sidebar a { color: #a9a9a9; transition: color 0.2s ease-in-out; }
.channel-sidebar a:hover, .channel-sidebar a.fw-bold.text-white { color: #ffffff !important; }

/* --- Custom Pink Button Style --- */
.btn-pink {
    --bs-btn-color: #fff;
    --bs-btn-bg: #ec729c;
    --bs-btn-border-color: #db618b;
    --bs-btn-hover-color: #fff;
    --bs-btn-hover-bg: #e35a8b;
    --bs-btn-hover-border-color: #e35a8b;
    --bs-btn-active-color: #fff;
    --bs-btn-active-bg: #d8487b;
    --bs-btn-active-border-color: #d8487b;
    --bs-btn-disabled-bg: #ec729c;
    --bs-btn-disabled-border-color: #ec729c;
}

#typing-indicator {
    min-height: 20px; /* Reserve a fixed minimum height */
    padding-left: 0.75rem; /* Apply padding consistently */
    transition: opacity 0.3s ease-in-out; /* Add a smooth fade effect */
}

/* --- WYSIWYG Editor Styles --- */
.wysiwyg-editor-container { border: 1px solid #ced4da; border-radius: 0.25rem; background-color: #fff; transition: border-color 0.15s ease-in-out; }
.wysiwyg-toolbar { padding: 0.375rem 0.75rem; background-color: #f8f9fa; border-bottom: 1px solid #dee2e6; display: flex; flex-wrap: wrap; gap: 0.5rem; }
.wysiwyg-toolbar-bottom { border-top: 1px solid #dee2e6; border-bottom: 0; }
.wysiwyg-toolbar button { background: none; border: 1px solid transparent; border-radius: 3px; padding: 4px 8px; cursor: pointer; font-size: 16px; line-height: 1; }
.wysiwyg-toolbar button:hover { background-color: #e2e6ea; }
.wysiwyg-toolbar button.active { background-color: #cfe2ff; color: #0d6efd; }
.wysiwyg-content { min-height: 38px; max-height: 30vh; overflow-y: auto; padding: 0.5rem 0.75rem; word-wrap: break-word; }
#chat-message-input, .toolbar-hidden { display: none; }
#markdown-toggle-view { height: 38px; min-height: 38px; resize: none; padding: 0.5rem 0.75rem; line-height: 1.5; max-height: 30vh; overflow-y: auto; }
.wysiwyg-editor-container > textarea.form-control { border: 0; border-radius: 0; }
kbd { padding: 0.1em 0.4em; border-radius: 3px; border: 1px solid #b4b4b4; background-color: #f7f7f7; color: #333; font-size: 0.8em; font-family: monospace; }

/* send button */
.send-btn-dynamic {
    background-color: #fdf5f8;
    color: #495057;
    border: 1px solid #ec729c;
    padding: 0.375rem 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out;
}

.send-btn-dynamic i {
    color: #ec729c;
}

.send-btn-dynamic .send-shortcut {
    border-left: 1px solid rgba(236, 114, 156, 0.4);
    padding-left: 0.6rem;
    display: flex;
    align-items: center;
    gap: 0.2rem;
}

.send-btn-dynamic:hover {
    background-color: #f8f9fa;
    border-color: #e35a8b;
}

.wysiwyg-content:focus, #markdown-toggle-view:focus { outline: 0 !important; box-shadow: none !important; }

.wysiwyg-content[data-placeholder]:not(:focus):empty::before {
    content: attr(data-placeholder);
    color: #6c757d; /* Standard Bootstrap placeholder color */
    pointer-events: none;
    display: block; /* For top/bottom padding */
}

[data-bs-theme="dark"] .wysiwyg-content,
[data-bs-theme="dark"] .wysiwyg-editor-container textarea {
    background-color: #40444b;
    color: #dcddde;
}
[data-bs-theme="dark"] .wysiwyg-content:focus, textarea:focus { outline: 0 !important; box-shadow: none !important; }

/* --- Rendered Message Content Styles --- */
.message-content > * + * { margin-top: 0.6em; }
.message-content ul, .message-content ol { padding-left: 2em; padding-bottom: 0.4em;}
.message-content blockquote { border-left: 4px solid cornflowerblue; padding-left: 1rem; color: #555555; padding-bottom: 0.4em;}
.wysiwyg-content blockquote { border-left: 4px solid cornflowerblue; padding-left: 1rem; color: #555555; margin: 0.5em 0; }
.message-content p, .message-content ul, .message-content ol, .message-content blockquote { margin: 0; }

/* --- Profile Button & Presence Styles --- */
.workspace-logo { font-size: 1.2rem; font-weight: bold; padding: 0.5rem; background-color: #49274b; border-radius: 8px; width: 44px; height: 44px; margin: 0 auto; display: flex; align-items: center; justify-content: center; }
.profile-button-container { padding-bottom: 0.5rem; }
.profile-button-container a { text-decoration: none; }
.profile-avatar { position: relative; width: 36px; height: 36px; background-color: #49274b; border-radius: 50%; color: white; font-size: 1.1rem; font-weight: bold; display: flex; align-items: center; justify-content: center; margin: 0 auto; transition: box-shadow 0.2s ease-in-out; text-decoration: none; }
.profile-avatar:hover { box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.2); }
.profile-header-avatar { position: relative; width: 60px; height: 60px; background-color: #007bff; border-radius: 50%; color: white; font-size: 1.5rem; font-weight: bold; display: flex; align-items: center; justify-content: center; transition: box-shadow 0.2s ease-in-out; }
.profile-header-avatar .presence-indicator { position: absolute; bottom: 2px; right: 2px; width: 16px; height: 16px; border-radius: 50%; border: 3px solid #ffffff; }
.presence-online { background-color: #28a745; }
.presence-away { background-color: #6c757d; }
.presence-busy { background-color: #ffc107; }
.presence-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; vertical-align: middle; }
.profile-avatar .presence-indicator { position: absolute; bottom: -2px; right: -2px; width: 12px; height: 12px; border-radius: 50%; border: 2px solid #3f0e40; }

 /* --- DM List Avatar & Presence Styles --- */
.sidebar-avatar {
    position: relative;
    flex-shrink: 0; /* Prevent the avatar from shrinking */
}

.sidebar-avatar .presence-indicator {
    position: absolute;
    bottom: -2px;
    right: -2px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    /* The border color should match the sidebar background */
    border: 2px solid #4a154b;
}

/* --- Dark Mode Override for DM List Presence --- */
[data-bs-theme="dark"] .sidebar-avatar .presence-indicator {
    /* Match the dark mode channel sidebar background */
    border-color: #222529;
}

/* --- Dark Mode Overrides --- */
[data-bs-theme="dark"] {
    /* Main Layout */
    .workspace-sidebar { background-color: #1a1d21; }
    .channel-sidebar { background-color: #222529; }
    .main-content, .container-fluid { background-color: #2f3136 !important; }
    .chat-messages, .chat-input-form { background-color: #363f4f; }

    /* WYSIWYG Editor */
    .wysiwyg-editor-container { background-color: #40444b; border-color: #2f3136; }
    .wysiwyg-toolbar, .wysiwyg-toolbar-bottom { background-color: #40444b; border-color: #2f3136 !important; }
    .wysiwyg-content, #markdown-toggle-view { background-color: #40444b; color: #dcddde; }
    .wysiwyg-toolbar button:hover { background-color: #4e5258; }

    /* Send Button */
    .send-btn-dynamic {
        color: #dcddde;
        background-color: #40444b;
        border-color: #ec729c;
    }
    .send-btn-dynamic:hover {
        color: #dcddde;
        background-color: #4e5258;
        border-color: #e35a8b;
    }
    .send-btn-dynamic i {
        color: #ec729c;
    }

    /* Blockquotes */
    .message-content blockquote, .wysiwyg-content blockquote { border-left-color: cornflowerblue; color: #b9bbbe; }

    .quoted-reply {
        background-color: #2f3136; /* A darker background that fits the theme */
        color: #b9bbbe; /* A light, readable text color */
    }

    /* Dark mode style for editing block */
    .editing-block {
        background-color: #494a2b; /* Dark yellow/olive */
        border-left-color: #ffc107; /* Keep the amber color for visibility */
        color: #b9bbbe;
    }

    /* Profile Page Cards */
    .card { background-color: #36393f; border-color: #40444b; }
    .card-header { background-color: transparent; border-bottom-color: #40444b; }

    /* Presence dot borders */
    .profile-avatar .presence-indicator { border-color: #1a1d21; }
    .profile-header-avatar .presence-indicator { border-color: #2f3136; }

    /* Mentioned messages */
    .mentioned-message {
        background-color: #494a2b; /* A muted, dark yellow */
        border-left-color: #ffd700;
        color: #dcddde;
    }
}

/* --- Dark Mode Message Toolbar --- */
[data-bs-theme="dark"] .message-toolbar {
    background-color: #36393f; /* A dark card-like background */
    border-color: #40444b;     /* A slightly lighter border */
}

/* Override the default .btn-light style for buttons inside the dark toolbar */
[data-bs-theme="dark"] .message-toolbar .btn-light {
    --bs-btn-color: #b9bbbe;             /* Light gray icon color */
    --bs-btn-bg: transparent;              /* No background */
    --bs-btn-border-color: transparent;    /* No border */
    --bs-btn-hover-bg: #4e5258;         /* Subtle dark hover background */
    --bs-btn-hover-color: #ffffff;           /* White icon on hover */
    --bs-btn-hover-border-color: #e35a8b; /* Our pink theme color on hover */
    --bs-btn-active-bg: #5a5f66;         /* Slightly darker for active/click state */
    --bs-btn-active-color: #ffffff;
}

/* --- Emoji Picker Styles --- */
[id^="emoji-picker-container"] {
    position: absolute;
    bottom: 100%; /* Position it right above the input container */
    right: 0;
    z-index: 1050; /* Ensure it appears above other elements */
    margin-bottom: 5px; /* Add a little space */
}

/* The picker itself comes with a shadow, but we can style it if needed */
emoji-picker {
    --indicator-color: #ec729c; /* Change the selection indicator color */
}

/* --- Emoji Reaction Pill Styles --- */
.reaction-pill {
    --reaction-bg: #f8f9fa;
    --reaction-border: #dee2e6;
    --reaction-text: #212529;
    --user-reaction-bg: #fdf5f8;
    --user-reaction-border: #ec729c;
    --user-reaction-text: #495057;

    background-color: var(--reaction-bg);
    border: 1px solid var(--reaction-border);
    color: var(--reaction-text);
    padding: 2px 8px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    transition: all 0.2s ease-in-out;
}

.reaction-pill:hover {
    border-color: #adb5bd;
}

.reaction-pill.user-reacted {
    background-color: var(--user-reaction-bg);
    border-color: var(--user-reaction-border);
    color: var(--user-reaction-text);
}

.reaction-pill.user-reacted:hover {
     border-color: #e35a8b;
}

[data-bs-theme="dark"] .reaction-pill {
    --reaction-bg: #40444b;
    --reaction-border: #2f3136;
    --reaction-text: #dcddde;
    --user-reaction-bg: #40444b;
    --user-reaction-border: #ec729c;
    --user-reaction-text: #f0d8e1;
}

[data-bs-theme="dark"] .reaction-pill:hover {
    border-color: #5d6268;
}

[data-bs-theme="dark"] .reaction-pill.user-reacted:hover {
    border-color: #f0a2bd;
}

/* --- Attachment Preview Styles --- */
#attachment-previews.has-attachments {
    display: flex !important; /* Override the inline style to show the container */
    border-bottom: 1px solid #dee2e6;
}

.attachment-thumbnail {
    position: relative;
    width: 70px;
    height: 70px;
}

.attachment-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 6px;
}

.attachment-thumbnail .remove-attachment-btn {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    border: none;
    font-size: 12px;
    line-height: 20px;
    text-align: center;
    padding: 0;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

[data-bs-theme="dark"] #attachment-previews.has-attachments {
    border-bottom-color: #2f3136 !important;
}

[data-bs-theme="dark"] #attachment-previews {
    border-bottom-color: #2f3136 !important;
}

/* --- Search Bar & Results --- */
#global-search-container {
    background-color: #f8f9fa;
    flex-shrink: 0;
}

#global-search-wrapper {
    max-width: 70%;
    margin: 0 auto;
}

#search-results-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #ffffff;
    z-index: 100;
    display: none; /* Initially hidden */
    flex-direction: column;
}

[data-bs-theme="dark"] #global-search-container {
    background-color: #222529; /* Match dark channel sidebar */
}

[data-bs-theme="dark"] #search-results-overlay {
    background-color: #2f3136; /* Match dark main content */
}

/* --- Attachment Image Grid Styles --- */
/* --- Attachment Image Grid Styles --- */
.attachment-grid {
    display: grid;
    gap: 4px;
    max-width: 380px; /* Limit the max width of the grid */
    border-radius: 12px;
    overflow: hidden; /* This is key to making the corner radius apply to child images */
}

.attachment-grid-item {
    position: relative;
    background-color: #f0f0f0; /* Fallback color while images load */
    min-height: 0; /* Prevents content from stretching the grid cell */
}

/* This new rule ensures the link fills the cell */
.attachment-grid-item a {
    display: block;
    height: 100%;
    width: 100%;
}

.attachment-grid-item img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures images fill their grid area without distortion */
    display: block;
}

/* Layout for a single image */
.attachment-grid[data-count="1"] {
    grid-template-columns: 1fr;
    max-height: 300px;
}

/* Layout for two images */
.attachment-grid[data-count="2"] {
    grid-template-columns: 1fr 1fr;
    aspect-ratio: 16 / 9;
}

/* Layout for three images */
.attachment-grid[data-count="3"] {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr; /* Explicitly define two equal rows */
    aspect-ratio: 1 / 1;
}

.attachment-grid[data-count="3"] .attachment-grid-item:first-child {
    grid-row: span 2;
}

/* Layout for four or more images */
.attachment-grid[data-count="4+"] {
    grid-template-columns: 1fr 1fr;
}

/* Force items in the 4+ grid to be square */
.attachment-grid[data-count="4+"] .attachment-grid-item {
    aspect-ratio: 1 / 1;
}

/* The "+N" overlay for when there are more than 4 images */
.attachment-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    font-size: 2rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}

[data-bs-theme="dark"] .attachment-grid-item {
    background-color: #2f3136;
}

/* --- Search Bar & Results --- */
#global-search-container {
    background-color: #f8f9fa;
    flex-shrink: 0;
}
.global-search-wrapper {
    max-width: 70%;
    margin: 0 auto;
}
#search-results-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #ffffff;
    z-index: 100;
    display: none; /* Initially hidden */
}
[data-bs-theme="dark"] #global-search-container {
    background-color: #222529;
}
[data-bs-theme="dark"] #search-results-overlay {
    background-color: #2f3136;
}
.search-results-container {
    overflow-y: auto;
    flex-grow: 1;
}
.search-result-item {
    border-bottom: 1px solid var(--bs-border-color);
}
.search-result-item:last-child {
    border-bottom: none;
}

/* --- Custom Emoji Popover Styles --- */
.popover.emoji-popover {
    --bs-popover-max-width: 360px; /* Set max-width to fit the picker */
    border: none;
    box-shadow: var(--bs-box-shadow);
}

.popover.emoji-popover .popover-header {
    display: none; /* The picker has its own header/search */
}

.popover.emoji-popover .popover-body {
    padding: 0; /* Remove default padding so the picker fits snugly */
}

/* --- Custom Accordion Styles --- */
.accordion-button:focus {
    /* Replace the blue focus ring with our pink theme color */
    border-color: #ec729c;
    box-shadow: 0 0 0 0.25rem rgba(236, 114, 156, 0.25);
}

.accordion-button:not(.collapsed) {
    /* Use the subtle light pink from our old reaction style */
    background-color: #fdf5f8;
    /* Set a readable dark text color for the light background */
    color: #495057;
    /* Use a full border instead of just a bottom box-shadow */
    border: 1px solid #ec729c;
    /* Remove the default box-shadow that Bootstrap uses for its borders */
    box-shadow: none;
}

/* This is the default (collapsed, downward) arrow. Make it pink. */
.accordion-button::after {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ec729c'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
}

/* This specifically targets the expanded (upward) arrow to override Bootstrap's default blue. */
.accordion-button:not(.collapsed)::after {
     background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ec729c'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
}

/* --- Dark Mode Overrides for Accordion --- */
[data-bs-theme="dark"] .accordion-button:not(.collapsed) {
    /* A subtle, darker pink/purple background for dark mode */
    background-color: #5c3f4a;
    /* A light, readable text color for dark mode */
    color: #f0d8e1;
    border-color: #ec729c; /* Ensure border color is consistent in dark mode */
}


/* --- Custom Profile Edit Button --- */
#address-card .btn-warning {
    /* Set the main colors using Bootstrap's CSS variables */
    --bs-btn-color: #fff;                 /* White text */
    --bs-btn-bg: transparent;              /* No background fill */
    --bs-btn-border-color: #ec729c;       /* Pink border */

    /* Set the colors for the hover/active state */
    --bs-btn-hover-color: #fff;
    --bs-btn-hover-bg: #5c3f4a;
    --bs-btn-hover-border-color: #ec729c;
    --bs-btn-active-color: #fff;
    --bs-btn-active-bg: #d8487b;          /* A slightly darker pink for active state */
    --bs-btn-active-border-color: #d8487b;
}

/* Specifically target the icon within the button to make it pink */
#address-card .btn-warning i {
    color: #ec729c;
}

/* On hover, make the icon white to match the text */
#address-card .btn-warning:hover i {
    color: #fff;
}

/* --- Image Carousel Modal Styles --- */
#image-carousel-modal .modal-content {
    background-color: rgba(0, 0, 0, 0.85);
}

#image-carousel-modal .carousel-item {
    height: calc(100vh - 56px); /* Full viewport height minus header */
    text-align: center;
}

#image-carousel-modal .carousel-inner,
#image-carousel-modal .carousel-item img {
    max-height: 100%;
    max-width: 100%;
    object-fit: contain; /* This prevents images from being stretched or cropped */
    margin: auto; /* Center the image vertically and horizontally */
}

#image-carousel-modal .carousel-control-prev,
#image-carousel-modal .carousel-control-next {
    position: fixed; /* Position relative to the viewport */
    top: 50%;
    transform: translateY(-50%); /* Vertically center the buttons */
    width: 50px;
    height: 50px;
    background-color: rgba(0, 0, 0, 0.4);
    border-radius: 50%;
    opacity: 0.8;
    transition: opacity 0.2s ease-in-out;
}

#image-carousel-modal .carousel-control-prev {
    left: 20px; /* Position from the left edge */
}

#image-carousel-modal .carousel-control-next {
    right: 20px; /* Position from the right edge */
}

#image-carousel-modal .carousel-control-prev:hover,
#image-carousel-modal .carousel-control-next:hover {
    opacity: 1;
}

/* Ensure the icon inside is also styled, removing Bootstrap's default size */
#image-carousel-modal .carousel-control-prev-icon,
#image-carousel-modal .carousel-control-next-icon {
    width: 100%;
    height: 100%;
}

/* --- Thread Indicator Styles --- */
.thread-participant-avatars {
    display: flex;
}

.thread-participant-avatar {
    border-radius: 50%;
    border: 2px solid var(--bs-body-bg); /* Use CSS variable to adapt to light/dark mode */
    background-color: var(--bs-body-bg);
}

.thread-participant-avatar:not(:first-child) {
    margin-left: -10px; /* This creates the overlap effect */
}

/* --- System Announcement Message Styles --- */
.system-message {
    text-align: center;
    color: var(--bs-secondary-color); /* Adapts to light/dark mode */
    font-size: 0.875em;
    padding: 0.5rem 0;
}


/* --- Admin Layout --- */
.admin-layout {
  display: flex;
  min-height: 100vh;
}

.admin-sidebar {
  width: 280px;
  background-color: #f8f9fa;
  padding: 1.5rem;
  flex-shrink: 0;
  border-right: 1px solid #dee2e6;
  display: flex;
  flex-direction: column;
}

.admin-main-content {
  flex-grow: 1;
  padding: 2rem;
  background-color: #ffffff;
  overflow-y: auto;
}

/* Override for admin page to ensure full height layout */
body.admin-page {
  background-color: #f8f9fa; /* Match sidebar for seamless look */
}

.admin-sidebar .nav-link.active {
    background-color: #343a40 !important; /* A dark color for active state */
}

/* ... (keep all existing CSS above this) ... */

/* --- Admin Dark Mode --- */
[data-bs-theme="dark"] .admin-sidebar {
    background-color: #212529; /* Darker sidebar */
    border-right-color: #343a40;
}

[data-bs-theme="dark"] .admin-sidebar h3 {
    color: #f8f9fa; /* Lighter text for the title */
}

[data-bs-theme="dark"] .admin-main-content {
    background-color: #343a40; /* Dark main content area */
}

[data-bs-theme="dark"] .admin-sidebar .nav-link:not(.active) {
    color: #adb5bd; /* Lighter gray for non-active links */
}

[data-bs-theme="dark"] .admin-sidebar .nav-link:not(.active):hover {
    color: #f8f9fa; /* White on hover */
}

[data-bs-theme="dark"] .admin-sidebar .nav-link.active {
    background-color: #495057 !important; /* A medium dark color for active state */
}

[data-bs-theme="dark"] .card {
    background-color: #212529;
    border-color: #495057;
}

[data-bs-theme="dark"] h1,
[data-bs-theme="dark"] .h5,
[data-bs-theme="dark"] .text-gray-800 {
    color: #f8f9fa !important;
}

[data-bs-theme="dark"] .text-gray-300 {
    color: #6c757d !important;
}

[data-bs-theme="dark"] .table {
    --bs-table-bg: #212529;
    --bs-table-striped-bg: #2c3034;
    --bs-table-striped-color: #f8f9fa;
    --bs-table-active-bg: #373b3e;
    --bs-table-active-color: #f8f9fa;
    --bs-table-hover-bg: #323539;
    --bs-table-hover-color: #f8f9fa;
    color: #f8f9fa;
    border-color: #373b3e;
}

[data-bs-theme="dark"] body.admin-page {
    background-color: #343a40; /* Match the main content background */
}

/* --- Mention Styles --- */
a.mention-link {
    color: #ec729c; /* Theme pink */
    text-decoration: none;
    padding: 2px 4px;
    border-radius: 4px;
    transition: background-color 0.2s ease-in-out;
}

a.mention-link:hover {
    background-color: #fbe4ed; /* A slightly darker pink on hover */
    color: #d8487b;
}

.mention-special {
    color: #0d6efd; /* Bootstrap primary blue */
    font-weight: 600;
    background-color: #cfe2ff;
    padding: 2px 4px;
    border-radius: 4px;
}

/* Dark Mode Overrides for Mentions */
[data-bs-theme="dark"] a.mention-link {
    color: #ec729c; /* Use the theme pink for the text color */
    background-color: transparent; /* Remove the background */
    padding: 0; /* Remove padding when there's no background */
}

[data-bs-theme="dark"] a.mention-link:hover {
    background-color: transparent; /* Ensure no background on hover either */
    color: #f0d8e1; /* Lighter pink on hover */
    text-decoration: underline; /* Add underline for better affordance */
}

[data-bs-theme="dark"] .mention-special {
    color: #80bfff;
    background-color: #0d6efd40; /* Blue with alpha */
}

/* --- Jumbo Emoji Styles --- */
.message-content.jumbo-emoji {
    font-size: 3rem; /* Makes the emoji about 3x bigger */
    line-height: 1.2;
}

/* The markdown filter wraps content in a <p> tag. Remove its margin. */
.message-content.jumbo-emoji p {
    margin-bottom: 0;
}
